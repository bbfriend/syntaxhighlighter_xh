tinymce.PluginManager.requireLangPack("sh4tinymce"),tinymce.PluginManager.add("sh4tinymce",function(e,t){function a(){function t(e){for(var t=e.split(";"),a={},l=0;l<t.length;l++){var i=t[l].split(":");a[i[0].replace(/\-/g,"")]=i[1]}tinymce.each(a,function(e,t){"brush"==t?s.language!=e&&(s.language=e):(e="true"==e?!0:"false"==e?!1:e,"highlight"==t&&(e=e.replace(/\[/g,"").replace(/\]/g,"")),s[t]=e)})}function a(t){var a=t.data.code;a=a.replace(/\</g,"&lt;").replace(/\>/g,"&gt;");var l=t.data.language?t.data.language:g,n=t.data.collapse!=r.collapse?";collapse:"+t.data.collapse:"",o=t.data.autolinks!=r.autolinks?";auto-links:"+t.data.autolinks:"",c=t.data.gutter!=r.gutter?";gutter:"+t.data.gutter:"",s=t.data.htmlscript!=r.htmlscript?";html-script:"+t.data.htmlscript:"",p=t.data.toolbar!=r.toolbar?";toolbar:"+t.data.toolbar:"",d=t.data.firstline!=r.firstline?";first-line:"+t.data.firstline:"",x=-1!=t.data.highlight.indexOf(",")?"[":"",m=-1!=t.data.highlight.indexOf(",")?"]":"",b=t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"")!=r.highlight?";highlight:"+x+t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"").replace(/,$/g,"")+m:"",v=t.data.tabsize!=r.tabsize?";tab-size:"+t.data.tabsize:"";i=e.dom.create("pre",{"class":"brush:"+l+n+o+c+s+p+d+b+v,contenteditable:"false"},a),h?e.dom.replace(i,u):e.insertContent(e.dom.getOuterHTML(i)+"<br>")}var l,i,n,o,c=(e.dom,e.selection),s={},r={},g="html",h=!1,u=c.getNode();r.autolinks=!0,r.collapse=!1,r.firstline="1",r.gutter=!0,r.highlight="",r.htmlscript=!1,r.tabsize="4",r.toolbar=!0,s.language="",s.autolinks=r.autolinks,s.collapse=r.collapse,s.firstline=r.firstline,s.gutter=r.gutter,s.highlight=r.highlight,s.htmlscript=r.htmlscript,s.tabsize=r.tabsize,s.toolbar=r.toolbar;var p=[{text:"Language",value:""},{text:"ActionScript3",value:"as3"},{text:"Bash/shell",value:"bash"},{text:"ColdFusion",value:"cf"},{text:"C#",value:"csharp"},{text:"C++",value:"cpp"},{text:"CSS",value:"css"},{text:"Delphi",value:"delphi"},{text:"Diff",value:"diff"},{text:"Erlang",value:"erl"},{text:"Groovy",value:"groovy"},{text:"HTML",value:"html"},{text:"Java",value:"java"},{text:"JavaFX",value:"jfx"},{text:"JavaScript",value:"js"},{text:"Perl",value:"perl"},{text:"PHP",value:"php"},{text:"PowerShell",value:"ps"},{text:"Python",value:"py"},{text:"Ruby",value:"ruby"},{text:"Scala",value:"scala"},{text:"SQL",value:"sql"},{text:"Text",value:"plain"},{text:"Visual Basic",value:"vb"},{text:"XML",value:"xml"}];"pre"==u.nodeName.toLowerCase()&&-1!=u.className.indexOf("brush:")?(h=!0,n=$(u).html(),n=n.replace(/\&lt\;/gi,"<").replace(/\&gt\;/gi,">"),o=u.className,o=o.replace(/ /g,""),t(o)):(n=c.getContent({format:"text"}),s.autolinks=!1,s.toolbar=!1);for(var d=0;d<p.length;d++)p[d].value==s.language&&(p[d].selected=!0);s.code=n,"&nbsp;"==s.code&&(s.code=""),l=e.windowManager.open({title:"SH4TinyMCE - Code Editor",data:s,minWidth:450,body:[{name:"language",type:"listbox",values:p},{name:"code",type:"textbox",minHeight:200,multiline:!0},{type:"container",layout:"flex",direction:"row",align:"center",spacing:7,items:[{name:"collapse",type:"checkbox",text:"Collapse",checked:s.collapse},{name:"autolinks",type:"checkbox",text:"Autolinks",checked:s.autolinks},{name:"gutter",type:"checkbox",text:"Gutter",checked:s.gutter},{name:"htmlscript",type:"checkbox",text:"Html script",checked:s.htmlscript},{name:"toolbar",type:"checkbox",text:"Toolbar",checked:s.toolbar}]},{type:"form",padding:0,labelGap:5,spacing:5,direction:"row",items:[{name:"firstline",type:"textbox",label:"First Line",size:3,value:s.firstline},{name:"highlight",type:"textbox",label:"Highlight",size:10,value:s.highlight},{name:"tabsize",type:"textbox",label:"Tab size",size:3,value:s.tabsize}]}],onsubmit:a})}tinymce.DOM.loadCSS(t+"/style/style.css"),e.addButton("sh4tinymce",{icon:"sh4tinymce",tooltip:"Insert/Edit Code",onclick:a,onPostRender:function(){var t=this;e.on("NodeChange",function(e){t.active("PRE"==e.element.nodeName)})}}),e.addMenuItem("sh4tinymce",{text:"SH4TinyMCE",icon:"sh4tinymce",context:"insert",onclick:a})});